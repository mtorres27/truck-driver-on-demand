h1 Editing Company

= simple_form_for([:admin, @company], html: { multipart: true }) do |f|
  = f.error_notification

  = render "/company/profiles/edit_company_profile", f: f
  = f.input :disabled

  .form-actions
    = f.button :submit, class: "btn btn-primary"

hr
= link_to 'Show', admin_company_path(@company)
'  |
= link_to 'Back', admin_companies_path

javascript:
  function toggle_province(country){
    if (country == "ca"){
      $(".province_line").removeClass('hidden');
      $(".state_line").addClass('hidden');
    }
    else{
      $('#company_province').val('');
      $(".province_line").addClass('hidden');
      $(".state_line").removeClass('hidden');
    }
  }

  $(document).ready(function() {
    if ($('#company_country').val() != ""){
      toggle_province($('#company_country').val())
    }
    $('#company_country').on('change', function(){
      toggle_province($(this).val())
    });
  });

  var updateHeaderImage = function() {
    $("#edit-company-profile-header").click();
    $("#edit-company-profile-header").on('change', function(e) {
      var imgPath = $(this)[0].value;
      var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
      var image_holder = $("#company-edit-profile__header");

      if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
        if (typeof (FileReader) != "undefined") {
          var reader = new FileReader();
          reader.onload = function (e) {
            image_holder.attr('src', e.target.result);
          }

          reader.readAsDataURL($(this)[0].files[0]);
        }
      } else {
        alert("Only images can be selected.");
      }
    });
  }

  var updateProfilePicture = function() {
    $("#edit-company-profile-avatar").click();
    $("#edit-company-profile-avatar").on('change', function() {
      var imgPath = $(this)[0].value;
      var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
      var image_holder = $("#company-edit-profile__avatar");

      if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
        if (typeof (FileReader) != "undefined") {
          var reader = new FileReader();
          reader.onload = function (e) {
            image_holder.attr('src', e.target.result)
          }

          reader.readAsDataURL($(this)[0].files[0]);
        }
      } else {
        alert("Only images can be selected.");
      }
    });
  }

  function uploadFeaturedProject (index) {
    if (index != undefined) {
      var ref = $("#company_featured_projects_attributes_"+index+"_file");
    } else {
      var ref = $(".add-new-project").prev('div').find(".nested_fields").find(".file-input--hidden");
    }


    ref.on('change', function() {
      var imgPath = $(this)[0].value;
      var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
      var image_holder = $(this).parent().parent().parent().find(".freelancer-profile__image").find(".authorable_attachment--full").find("img");
      if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
        if (typeof (FileReader) != "undefined") {
          var reader = new FileReader();
          reader.onload = function (e) {
            image_holder.attr('src', e.target.result)
          }

          reader.readAsDataURL($(this)[0].files[0]);
        }
      } else {
        alert("Only images can be selected.");
      }
    });

    ref.click();
  }